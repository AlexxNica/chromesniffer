/** * Chrome AppSniffer * * Detect apps run on current page and send back to background page. * Some part of this script was refered from Wappalyzer Firefox Addon. * * @author Bao Nguyen <contact@nqbao.com> * @license GPLv3 **/var _apps = {};var doc = document.documentElement;// 1: detect by script tagsvar scripts = doc.getElementsByTagName("script");var script_tests = {	'jQuery': /jquery/i,	'jQuery UI': /jquery-ui/i,	'Drupal': /drupal/i,	'Google Analytics': /google-analytics.com\/ga.js/i,	'Prototype': /prototype\.js/i,	'Joomla': /\/components\/com_/,	'Ubercart': /uc_cart/i};for (var idx in scripts){	var s = scripts[idx];	if (!s.src) continue;	s = s.src;	for (var t in script_tests)	{		if (t in _apps) continue;		if (script_tests[t].test(s))		{			_apps[t] = 1;		}	}}// 2: detect by meta tagsvar metas = doc.getElementsByTagName("meta");var meta_tests = {	'generator': {		'Joomla': /joomla/i,		'vBulletin': /vBulletin/i,		//'WordPress': /wordPress/i,		'XOOPS': /xoops/i,		'Plone': /plone/i,		'MediaWiki': /MediaWiki/i	},	'copyright': {		'phpBB': /phpBB/i	}};for (var idx in metas){	var m = metas[idx];	if (!meta_tests[m.name]) continue;		for (var t in meta_tests[m.name])	{		if (t in _apps) continue;		if (meta_tests[m.name][t].test(m.content))		{			_apps[t] = 1;		}	}}// 3: detect by domains// 4: detect by regexpvar text = document.documentElement.innerHTML;var text_tests = {	'SMF': /<script .+\s+var smf_/i,	'Magento': /var BLANK_URL = '[^>]+js\/blank\.html'/i,	'Tumblr': /<iframe src=("|')http:\/\/www\.tumblr\.com/i,	'WordPress': /<link rel=("|')stylesheet("|') [^>]+wp-content/i,};for (t in text_tests){	if (t in _apps) continue;	if (text_tests[t].test(text))	{		_apps[t] = 1;	}}// 5: detect by header// @todo// 6: detect based on built-in database// @todo// convert to arrayvar _apps_array = [];for (var a in _apps) _apps_array.push(a);_apps_array.sort();// send back to background pagechrome.extension.sendRequest({msg: "sniff",info: _apps_array}, function(response) {  // nothing});